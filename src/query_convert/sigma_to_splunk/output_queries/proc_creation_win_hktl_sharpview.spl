index=* sourcetype="WinEventLog:Security" EventCode=4688
 | search (Original_File_Name="SharpView.exe" OR New_Process_Name="*\SharpView.exe" OR Process_Command_Line="*['Add-RemoteConnection', 'Convert-ADName', 'ConvertFrom-SID', 'ConvertFrom-UACValue', 'Convert-SidToName', 'Export-PowerViewCSV', 'Find-DomainObjectPropertyOutlier', 'Find-DomainProcess', 'Find-DomainShare', 'Find-DomainUserEvent', 'Find-DomainUserLocation', 'Find-ForeignGroup', 'Find-ForeignUser', 'Find-GPOComputerAdmin', 'Find-GPOLocation', 'Find-Interesting', 'Find-LocalAdminAccess', 'Find-ManagedSecurityGroups', 'Get-CachedRDPConnection', 'Get-DFSshare', 'Get-DomainComputer', 'Get-DomainController', 'Get-DomainDFSShare', 'Get-DomainDNSRecord', 'Get-DomainFileServer', 'Get-DomainForeign', 'Get-DomainGPO', 'Get-DomainGroup', 'Get-DomainGUIDMap', 'Get-DomainManagedSecurityGroup', 'Get-DomainObject', 'Get-DomainOU', 'Get-DomainPolicy', 'Get-DomainSID', 'Get-DomainSite', 'Get-DomainSPNTicket', 'Get-DomainSubnet', 'Get-DomainTrust', 'Get-DomainUserEvent', 'Get-ForestDomain', 'Get-ForestGlobalCatalog', 'Get-ForestTrust', 'Get-GptTmpl', 'Get-GroupsXML', 'Get-LastLoggedOn', 'Get-LoggedOnLocal', 'Get-NetComputer', 'Get-NetDomain', 'Get-NetFileServer', 'Get-NetForest', 'Get-NetGPO', 'Get-NetGroupMember', 'Get-NetLocalGroup', 'Get-NetLoggedon', 'Get-NetOU', 'Get-NetProcess', 'Get-NetRDPSession', 'Get-NetSession', 'Get-NetShare', 'Get-NetSite', 'Get-NetSubnet', 'Get-NetUser', 'Get-PathAcl', 'Get-PrincipalContext', 'Get-RegistryMountedDrive', 'Get-RegLoggedOn', 'Get-WMIRegCachedRDPConnection', 'Get-WMIRegLastLoggedOn', 'Get-WMIRegMountedDrive', 'Get-WMIRegProxy', 'Invoke-ACLScanner', 'Invoke-CheckLocalAdminAccess', 'Invoke-Kerberoast', 'Invoke-MapDomainTrust', 'Invoke-RevertToSelf', 'Invoke-Sharefinder', 'Invoke-UserImpersonation', 'Remove-DomainObjectAcl', 'Remove-RemoteConnection', 'Request-SPNTicket', 'Set-DomainObject', 'Test-AdminAccess']*")
| table _time, New_Process_Name, Process_Command_Line