index=* sourcetype="WinEventLog:Security" EventCode=4688
 | search (New_Process_Name="*\rundll32.exe" OR Original_File_Name="RUNDLL32.EXE") OR (Process_Command_Line="None") OR (Process_Command_Line="") OR (Process_Command_Line="*['.cpl ', '.cpl,', '.cpl"', ".cpl'", '.dll ', '.dll,', '.dll"', ".dll'", '.inf ', '.inf,', '.inf"', ".inf'"]*" OR Process_Command_Line="*['.cpl', '.dll', '.inf']") OR (Process_Command_Line="* -localserver *") OR (Parent_Process_Name="*\msiexec.exe" AND (Process_Command_Line=":\Windows\Installer\" OR Process_Command_Line=".tmp" OR Process_Command_Line="zzzzInvokeManagedCustomActionOutOfProc")) OR ((Parent_Process_Command_Line=":\Users\" OR Parent_Process_Command_Line="\AppData\Local\Microsoft\EdgeUpdate\Install\{" OR Parent_Process_Command_Line="\EDGEMITMP_" OR Parent_Process_Command_Line=".tmp\setup.exe" OR Parent_Process_Command_Line="--install-archive=" OR Parent_Process_Command_Line="--previous-version=" OR Parent_Process_Command_Line="--msedgewebview --verbose-logging --do-not-launch-msedge --user-level"))
| table _time, New_Process_Name, Process_Command_Line