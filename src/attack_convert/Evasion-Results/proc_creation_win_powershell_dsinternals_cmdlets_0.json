{
  "rule_name": "proc_creation_win_powershell_dsinternals_cmdlets_0",
  "original_command": "Add-ADDBSidHistory Add-ADNgcKey Add-ADReplNgcKey ConvertFrom-ADManagedPasswordBlob ConvertFrom-GPPrefPassword ConvertFrom-ManagedPasswordBlob ConvertFrom-UnattendXmlPassword ConvertFrom-UnicodePassword ConvertTo-AADHash ConvertTo-GPPrefPassword ConvertTo-KerberosKey ConvertTo-LMHash ConvertTo-MsoPasswordHash ConvertTo-NTHash ConvertTo-OrgIdHash ConvertTo-UnicodePassword Disable-ADDBAccount Enable-ADDBAccount Get-ADDBAccount Get-ADDBBackupKey Get-ADDBDomainController Get-ADDBGroupManagedServiceAccount Get-ADDBKdsRootKey Get-ADDBSchemaAttribute Get-ADDBServiceAccount Get-ADDefaultPasswordPolicy Get-ADKeyCredential Get-ADPasswordPolicy Get-ADReplAccount Get-ADReplBackupKey Get-ADReplicationAccount Get-ADSIAccount Get-AzureADUserEx Get-BootKey Get-KeyCredential Get-LsaBackupKey Get-LsaPolicy Get-SamPasswordPolicy Get-SysKey Get-SystemKey New-ADDBRestoreFromMediaScript New-ADKeyCredential New-ADNgcKey New-NTHashSet Remove-ADDBObject Save-DPAPIBlob Set-ADAccountPasswordHash Set-ADDBAccountPassword Set-ADDBBootKey Set-ADDBDomainController Set-ADDBPrimaryGroup Set-ADDBSysKey Set-AzureADUserEx Set-LsaPolicy Set-SamAccountPasswordHash Set-WinUserPasswordHash Test-ADDBPasswordQuality Test-ADPasswordQuality Test-ADReplPasswordQuality Test-PasswordQuality Unlock-ADDBAccount Write-ADNgcKey Write-ADReplNgcKey",
  "evasions": {
    "insertion": "Add-ADDBSidHistory Add-ADNgcKey Add-ADReplNgcKey ConvertFrom-ADManagedPasswordBlob ConvertFrom-GPPrefPassword ConvertFrom-ManagedPasswordBlob ConvertFrom-UnattendXmlPassword ConvertFrom-UnicodePassword ConvertTo-AADHash ConvertTo-GPPrefPassword ConvertTo-KerberosKey ConvertTo-LMHash ConvertTo-MsoPasswordHash ConvertTo-NTHash ConvertTo-OrgIdHash ConvertTo-UnicodePassword Disable-ADDBAccount Enable-ADDBAccount Get-ADDBAccount Get-ADDBBackupKey Get-ADDBDomainController Get-ADDBGroupManagedServiceAccount Get-ADDBKdsRootKey Get-ADDBSchemaAttribute Get-ADDBServiceAccount Get-ADDefaultPasswordPolicy Get-ADKeyCredential Get-ADPasswordPolicy Get-ADReplAccount Get-ADReplBackupKey Get-ADReplicationAccount Get-ADSIAccount Get-AzureADUserEx Get-BootKey Get-KeyCredential Get-LsaBackupKey \\\"Get-LsaPolicy\\\" Get-SamPasswordPolicy Get-SysKey Get-SystemKey New-ADDBRestoreFromMediaScript New-ADKeyCredential New-ADNgcKey New-NTHashSet Remove-ADDBObject Save-DPAPIBlob Set-ADAccountPasswordHash Set-ADDBAccountPassword Set-ADDBBootKey Set-ADDBDomainController Set-ADDBPrimaryGroup Set-ADDBSysKey Set-AzureADUserEx Set-LsaPolicy Set-SamAccountPasswordHash Set-WinUserPasswordHash Test-ADDBPasswordQuality Test-ADPasswordQuality Test-ADReplPasswordQuality Test-PasswordQuality Unlock-ADDBAccount Write-ADNgcKey Write-ADReplNgcKey",
    "substitution": "Add-ADDBSidHistory Add-ADNgcKey Add-ADReplNgcKey ConvertFrom-ADManagedPasswordBlob ConvertFrom-GPPrefPassword ConvertFrom-ManagedPasswordBlob ConvertFrom-UnattendXmlPassword ConvertFrom-UnicodePassword ConvertTo-AADHash ConvertTo-GPPrefPassword ConvertTo-KerberosKey ConvertTo-LMHash ConvertTo-MsoPasswordHash ConvertTo-NTHash ConvertTo-OrgIdHash ConvertTo-UnicodePassword Disable-ADDBAccount Enable-ADDBAccount Get-ADDBAccount Get-ADDBBackupKey Get-ADDBDomainController Get-ADDBGroupManagedServiceAccount Get-ADDBKdsRootKey Get-ADDBSchemaAttribute Get-ADDBServiceAccount Get-ADDefaultPasswordPolicy Get-ADKeyCredential Get-ADPasswordPolicy Get-ADReplAccount Get-ADReplBackupKey Get-ADReplicationAccount Get-ADSIAccount Get-AzureADUserEx Get-BootKey Get-KeyCredential Get-LsaBackupKey Get-LsaPolicy Get-SamPasswordPolicy Get-SysKey Get-SystemKey New-ADDBRestoreFromMediaScript New-ADKeyCredential New-ADNgcKey New-NTHashSet Remove-ADDBObject Save-DPAPIBlob Set-ADAccountPasswordHash Set-ADDBAccountPassword Set-ADDBBootKey Set-ADDBDomainController Set-ADDBPrimaryGroup Set-ADDBSysKey Set-AzureADUserEx Set-LsaPolicy Set-SamAccountPasswordHash Set-WinUserPasswordHash Test-ADDBPasswordQuality Test-ADPasswordQuality Test-ADReplPasswordQuality Test-PasswordQuality Unlock-ADDBAccount Write-ADNgcKey Write-ADReplNgcKey #substitution",
    "omission": "Add-ADDBSidHistory Add-ADNgcKey Add-ADReplNgcKey ConvertFrom-ADManagedPasswordBlob ConvertFrom-GPPrefPassword ConvertFrom-ManagedPasswordBlob ConvertFrom-UnattendXmlPassword ConvertFrom-UnicodePassword ConvertTo-AADHash ConvertTo-GPPrefPassword ConvertTo-KerberosKey ConvertTo-LMHash ConvertTo-MsoPasswordHash ConvertTo-NTHash ConvertTo-OrgIdHash ConvertTo-UnicodePassword Disable-ADDBAccount Enable-ADDBAccount Get-ADDBAccount Get-ADDBBackupKey Get-ADDBDomainController Get-ADDBGroupManagedServiceAccount Get-ADDBKdsRootKey Get-ADDBSchemaAttribute Get-ADDBServiceAccount Get-ADDefaultPasswordPolicy Get-ADKeyCredential Get-ADPasswordPolicy Get-ADReplAccount Get-ADReplBackupKey Get-ADReplicationAccount Get-ADSIAccount Get-AzureADUserEx Get-BootKey Get-KeyCredential Get-LsaBackupKey Get-LsaPolicy Get-SamPasswordPolicy Get-SysKey Get-SystemKey New-ADDBRestoreFromMediaScript New-ADKeyCredential New-ADNgcKey New-NTHashSet Remove-ADDBObject Save-DPAPIBlob Set-ADAccountPasswordHash Set-ADDBAccountPassword Set-ADDBBootKey Set-ADDBDomainController Set-ADDBPrimaryGroup Set-ADDBSysKey Set-AzureADUserEx Set-LsaPolicy Set-SamAccountPasswordHash Set-WinUserPasswordHash Test-ADDBPasswordQuality Test-ADPasswordQuality Test-ADReplPasswordQuality Test-PasswordQuality Unlock-ADDBAccount Write-ADNgcKey Write-ADReplNgcKey # omission",
    "reordering": "Add-ADDBSidHistory Add-ADNgcKey Add-ADReplNgcKey ConvertFrom-ADManagedPasswordBlob ConvertFrom-GPPrefPassword ConvertFrom-ManagedPasswordBlob ConvertFrom-UnattendXmlPassword ConvertFrom-UnicodePassword ConvertTo-AADHash ConvertTo-GPPrefPassword ConvertTo-KerberosKey ConvertTo-LMHash ConvertTo-MsoPasswordHash ConvertTo-NTHash ConvertTo-OrgIdHash ConvertTo-UnicodePassword Disable-ADDBAccount Enable-ADDBAccount Get-ADDBAccount Get-ADDBBackupKey Get-ADDBDomainController Get-ADDBGroupManagedServiceAccount Get-ADDBKdsRootKey Get-ADDBSchemaAttribute Get-ADDBServiceAccount Get-ADDefaultPasswordPolicy Get-ADKeyCredential Get-ADPasswordPolicy Get-ADReplAccount Get-ADReplBackupKey Get-ADReplicationAccount Get-ADSIAccount Get-AzureADUserEx Get-BootKey Get-KeyCredential Get-LsaBackupKey Get-LsaPolicy Get-SamPasswordPolicy Get-SysKey Get-SystemKey New-ADDBRestoreFromMediaScript New-ADKeyCredential New-ADNgcKey New-NTHashSet Remove-ADDBObject Save-DPAPIBlob Set-ADAccountPasswordHash Set-ADDBAccountPassword Set-ADDBBootKey Set-ADDBDomainController Set-ADDBPrimaryGroup Set-ADDBSysKey Set-AzureADUserEx Set-LsaPolicy Set-SamAccountPasswordHash Set-WinUserPasswordHash Test-ADDBPasswordQuality Test-ADPasswordQuality Test-ADReplPasswordQuality Test-PasswordQuality Unlock-ADDBAccount Write-ADNgcKey Write-ADReplNgcKey",
    "recoding": "powershell.exe -NoProfile -Command \"[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('QWRkLUFEREJTaWRIaXN0b3J5IEFkZC1BRE5nY0tleSBBZGQtQURSZXBsTmdjS2V5IENvbnZlcnRGcm9tLUFETWFuYWdlZFBhc3N3b3JkQmxvYiBDb252ZXJ0RnJvbS1HUFByZWZQYXNzd29yZCBDb252ZXJ0RnJvbS1NYW5hZ2VkUGFzc3dvcmRCbG9iIENvbnZlcnRGcm9tLVVuYXR0ZW5kWG1sUGFzc3dvcmQgQ29udmVydEZyb20tVW5pY29kZVBhc3N3b3JkIENvbnZlcnRUby1BQURIYXNoIENvbnZlcnRUby1HUFByZWZQYXNzd29yZCBDb252ZXJ0VG8tS2VyYmVyb3NLZXkgQ29udmVydFRvLUxNSGFzaCBDb252ZXJ0VG8tTXNvUGFzc3dvcmRIYXNoIENvbnZlcnRUby1OVEhhc2ggQ29udmVydFRvLU9yZ0lkSGFzaCBDb252ZXJ0VG8tVW5pY29kZVBhc3N3b3JkIERpc2FibGUtQUREQkFjY291bnQgRW5hYmxlLUFEREJBY2NvdW50IEdldC1BRERCQWNjb3VudCBHZXQtQUREQkJhY2t1cEtleSBHZXQtQUREQkRvbWFpbkNvbnRyb2xsZXIgR2V0LUFEREJHcm91cE1hbmFnZWRTZXJ2aWNlQWNjb3VudCBHZXQtQUREQktkc1Jvb3RLZXkgR2V0LUFEREJTY2hlbWFBdHRyaWJ1dGUgR2V0LUFEREJTZXJ2aWNlQWNjb3VudCBHZXQtQUREZWZhdWx0UGFzc3dvcmRQb2xpY3kgR2V0LUFES2V5Q3JlZGVudGlhbCBHZXQtQURQYXNzd29yZFBvbGljeSBHZXQtQURSZXBsQWNjb3VudCBHZXQtQURSZXBsQmFja3VwS2V5IEdldC1BRFJlcGxpY2F0aW9uQWNjb3VudCBHZXQtQURTSUFjY291bnQgR2V0LUF6dXJlQURVc2VyRXggR2V0LUJvb3RLZXkgR2V0LUtleUNyZWRlbnRpYWwgR2V0LUxzYUJhY2t1cEtleSBHZXQtTHNhUG9saWN5IEdldC1TYW1QYXNzd29yZFBvbGljeSBHZXQtU3lzS2V5IEdldC1TeXN0ZW1LZXkgTmV3LUFEREJSZXN0b3JlRnJvbU1lZGlhU2NyaXB0IE5ldy1BREtleUNyZWRlbnRpYWwgTmV3LUFETmdjS2V5IE5ldy1OVEhhc2hTZXQgUmVtb3ZlLUFEREJPYmplY3QgU2F2ZS1EUEFQSUJsb2IgU2V0LUFEQWNjb3VudFBhc3N3b3JkSGFzaCBTZXQtQUREQkFjY291bnRQYXNzd29yZCBTZXQtQUREQkJvb3RLZXkgU2V0LUFEREJEb21haW5Db250cm9sbGVyIFNldC1BRERCUHJpbWFyeUdyb3VwIFNldC1BRERCU3lzS2V5IFNldC1BenVyZUFEVXNlckV4IFNldC1Mc2FQb2xpY3kgU2V0LVNhbUFjY291bnRQYXNzd29yZEhhc2ggU2V0LVdpblVzZXJQYXNzd29yZEhhc2ggVGVzdC1BRERCUGFzc3dvcmRRdWFsaXR5IFRlc3QtQURQYXNzd29yZFF1YWxpdHkgVGVzdC1BRFJlcGxQYXNzd29yZFF1YWxpdHkgVGVzdC1QYXNzd29yZFF1YWxpdHkgVW5sb2NrLUFEREJBY2NvdW50IFdyaXRlLUFETmdjS2V5IFdyaXRlLUFEUmVwbE5nY0tleQ==')) | Invoke-Expression\" "
  }
}