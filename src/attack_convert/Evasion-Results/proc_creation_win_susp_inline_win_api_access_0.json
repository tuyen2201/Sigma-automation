{
  "rule_name": "proc_creation_win_susp_inline_win_api_access_0",
  "original_command": "AddSecurityPackage AdjustTokenPrivileges Advapi32 CloseHandle CreateProcessWithToken CreatePseudoConsole CreateRemoteThread CreateThread CreateUserThread DangerousGetHandle DuplicateTokenEx EnumerateSecurityPackages FreeHGlobal FreeLibrary GetDelegateForFunctionPointer GetLogonSessionData GetModuleHandle GetProcAddress GetProcessHandle GetTokenInformation ImpersonateLoggedOnUser kernel32 LoadLibrary memcpy MiniDumpWriteDump ntdll OpenDesktop OpenProcess OpenProcessToken OpenThreadToken OpenWindowStation PtrToString QueueUserApc ReadProcessMemory RevertToSelf RtlCreateUserThread secur32 SetThreadToken VirtualAlloc VirtualFree VirtualProtect WaitForSingleObject WriteInt32 WriteProcessMemory ZeroFreeGlobalAllocUnicode \\MpCmdRun.exe GetLoadLibraryWAddress32 \\CompatTelRunner.exe FreeHGlobal PtrToString kernel32 CloseHandle",
  "evasions": {
    "insertion": "AddSecurityPackage AdjustTokenPrivileges Advapi32 CloseHandle CreateProcessWithToken CreatePseudoConsole CreateRemoteThread CreateThread CreateUserThread DangerousGetHandle DuplicateTokenEx EnumerateSecurityPackages FreeHGlobal FreeLibrary GetDelegateForFunctionPointer GetLogonSessionData GetModuleHandle GetProcAddress GetProcessHandle GetTokenInformation ImpersonateLoggedOnUser kernel32 LoadLibrary memcpy MiniDumpWriteDump \\\"n\\\"\\\"t\\\"\\\"d\\\"\\\"l\\\"\\\"l\\\" OpenDesktop OpenProcess OpenProcessToken OpenThreadToken OpenWindowStation PtrToString QueueUserApc ReadProcessMemory RevertToSelf RtlCreateUserThread secur32 SetThreadToken VirtualAlloc VirtualFree VirtualProtect WaitForSingleObject WriteInt32 WriteProcessMemory ZeroFreeGlobalAllocUnicode \\MpCmdRun.exe GetLoadLibraryWAddress32 \\CompatTelRunner.exe FreeHGlobal PtrToString kernel32 CloseHandle",
    "substitution": "AddSecurityPackage AdjustTokenPrivileges Advapi32 CloseHandle CreateProcessWithToken CreatePseudoConsole CreateRemoteThread CreateThread CreateUserThread DangerousGetHandle DuplicateTokenEx EnumerateSecurityPackages FreeHGlobal FreeLibrary GetDelegateForFunctionPointer GetLogonSessionData GetModuleHandle GetProcAddress GetProcessHandle GetTokenInformation ImpersonateLoggedOnUser kernel32 LoadLibrary memcpy MiniDumpWriteDump ntdll OpenDesktop OpenProcess OpenProcessToken OpenThreadToken OpenWindowStation PtrToString QueueUserApc ReadProcessMemory RevertToSelf RtlCreateUserThread secur32 SetThreadToken VirtualAlloc VirtualFree VirtualProtect WaitForSingleObject WriteInt32 WriteProcessMemory ZeroFreeGlobalAllocUnicode \\MpCmdRun.exe GetLoadLibraryWAddress32 \\CompatTelRunner.exe FreeHGlobal PtrToString kernel32 CloseHandle #substitution",
    "omission": "AddSecurityPackage AdjustTokenPrivileges Advapi32 CloseHandle CreateProcessWithToken CreatePseudoConsole CreateRemoteThread CreateThread CreateUserThread DangerousGetHandle DuplicateTokenEx EnumerateSecurityPackages FreeHGlobal FreeLibrary GetDelegateForFunctionPointer GetLogonSessionData GetModuleHandle GetProcAddress GetProcessHandle GetTokenInformation ImpersonateLoggedOnUser kernel32 LoadLibrary memcpy MiniDumpWriteDump ntdll OpenDesktop OpenProcess OpenProcessToken OpenThreadToken OpenWindowStation PtrToString QueueUserApc ReadProcessMemory RevertToSelf RtlCreateUserThread secur32 SetThreadToken VirtualAlloc VirtualFree VirtualProtect WaitForSingleObject WriteInt32 WriteProcessMemory ZeroFreeGlobalAllocUnicode \\MpCmdRun GetLoadLibraryWAddress32 \\CompatTelRunner FreeHGlobal PtrToString kernel32 CloseHandle",
    "reordering": "AddSecurityPackage AdjustTokenPrivileges Advapi32 CloseHandle CreateProcessWithToken CreatePseudoConsole CreateRemoteThread CreateThread CreateUserThread DangerousGetHandle DuplicateTokenEx EnumerateSecurityPackages FreeHGlobal FreeLibrary GetDelegateForFunctionPointer GetLogonSessionData GetModuleHandle GetProcAddress GetProcessHandle GetTokenInformation ImpersonateLoggedOnUser kernel32 LoadLibrary memcpy MiniDumpWriteDump ntdll OpenDesktop OpenProcess OpenProcessToken OpenThreadToken OpenWindowStation PtrToString QueueUserApc ReadProcessMemory RevertToSelf RtlCreateUserThread secur32 SetThreadToken VirtualAlloc VirtualFree VirtualProtect WaitForSingleObject WriteInt32 WriteProcessMemory ZeroFreeGlobalAllocUnicode \\MpCmdRun.exe GetLoadLibraryWAddress32 \\CompatTelRunner.exe FreeHGlobal PtrToString kernel32 CloseHandle",
    "recoding": "powershell.exe -NoProfile -Command \"[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('QWRkU2VjdXJpdHlQYWNrYWdlIEFkanVzdFRva2VuUHJpdmlsZWdlcyBBZHZhcGkzMiBDbG9zZUhhbmRsZSBDcmVhdGVQcm9jZXNzV2l0aFRva2VuIENyZWF0ZVBzZXVkb0NvbnNvbGUgQ3JlYXRlUmVtb3RlVGhyZWFkIENyZWF0ZVRocmVhZCBDcmVhdGVVc2VyVGhyZWFkIERhbmdlcm91c0dldEhhbmRsZSBEdXBsaWNhdGVUb2tlbkV4IEVudW1lcmF0ZVNlY3VyaXR5UGFja2FnZXMgRnJlZUhHbG9iYWwgRnJlZUxpYnJhcnkgR2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIgR2V0TG9nb25TZXNzaW9uRGF0YSBHZXRNb2R1bGVIYW5kbGUgR2V0UHJvY0FkZHJlc3MgR2V0UHJvY2Vzc0hhbmRsZSBHZXRUb2tlbkluZm9ybWF0aW9uIEltcGVyc29uYXRlTG9nZ2VkT25Vc2VyIGtlcm5lbDMyIExvYWRMaWJyYXJ5IG1lbWNweSBNaW5pRHVtcFdyaXRlRHVtcCBudGRsbCBPcGVuRGVza3RvcCBPcGVuUHJvY2VzcyBPcGVuUHJvY2Vzc1Rva2VuIE9wZW5UaHJlYWRUb2tlbiBPcGVuV2luZG93U3RhdGlvbiBQdHJUb1N0cmluZyBRdWV1ZVVzZXJBcGMgUmVhZFByb2Nlc3NNZW1vcnkgUmV2ZXJ0VG9TZWxmIFJ0bENyZWF0ZVVzZXJUaHJlYWQgc2VjdXIzMiBTZXRUaHJlYWRUb2tlbiBWaXJ0dWFsQWxsb2MgVmlydHVhbEZyZWUgVmlydHVhbFByb3RlY3QgV2FpdEZvclNpbmdsZU9iamVjdCBXcml0ZUludDMyIFdyaXRlUHJvY2Vzc01lbW9yeSBaZXJvRnJlZUdsb2JhbEFsbG9jVW5pY29kZSBcTXBDbWRSdW4uZXhlIEdldExvYWRMaWJyYXJ5V0FkZHJlc3MzMiBcQ29tcGF0VGVsUnVubmVyLmV4ZSBGcmVlSEdsb2JhbCBQdHJUb1N0cmluZyBrZXJuZWwzMiBDbG9zZUhhbmRsZQ==')) | Invoke-Expression\" "
  }
}