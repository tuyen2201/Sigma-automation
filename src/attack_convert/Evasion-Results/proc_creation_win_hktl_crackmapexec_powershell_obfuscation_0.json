{
  "rule_name": "proc_creation_win_hktl_crackmapexec_powershell_obfuscation_0",
  "original_command": "\\powershell.exe \\pwsh.exe PowerShell.EXE pwsh.dll join split ( $ShellId[1]+$ShellId[13]+'x') ( $PSHome[ ]+$PSHOME[ ]+ ( $env:Public[13]+$env:Public[5]+'x') ( $env:ComSpec[4, ,25]-Join'') [1,3]+'x'-Join'')",
  "evasions": {
    "insertion": "\\powershell.exe \\pwsh.exe PowerShell.EXE pwsh.dll join split ( $ShellId[1]+$ShellId[13]+'x') \\\"(\\\" \\\"$PSHome[\\\" ]+$PSHOME[ ]+ ( $env:Public[13]+$env:Public[5]+'x') ( $env:ComSpec[4, ,25]-Join'') [1,3]+'x'-Join'')",
    "substitution": "\\powershell.exe \\pwsh.exe PowerShell.EXE pwsh.dll join split ( $ShellId[1]+$ShellId[13]+'x') ( $PSHome[ ]+$PSHOME[ ]+ ( $env:Public[13]+$env:Public[5]+'x') ( $env:ComSpec[4, ,25]-Join'') [1,3]+'x'-Join'') #substitution",
    "omission": "\\powershell \\pwsh PowerShell pwsh.dll join split ( $ShellId[1]+$ShellId[13]+'x') ( $PSHome[ ]+$PSHOME[ ]+ ( $env:Public[13]+$env:Public[5]+'x') ( $env:ComSpec[4, ,25]-Join'') [1,3]+'x'-Join'')",
    "reordering": "\\powershell.exe \\pwsh.exe PowerShell.EXE pwsh.dll join split ( $ShellId[1]+$ShellId[13]+'x') ( $PSHome[ ]+$PSHOME[ ]+ ( $env:Public[13]+$env:Public[5]+'x') ( $env:ComSpec[4, ,25]-Join'') [1,3]+'x'-Join'')",
    "recoding": "powershell.exe -EncodedCommand XABwAG8AdwBlAHIAcwBoAGUAbABsAC4AZQB4AGUAIABcAHAAdwBzAGgALgBlAHgAZQAgAFAAbwB3AGUAcgBTAGgAZQBsAGwALgBFAFgARQAgAHAAdwBzAGgALgBkAGwAbAAgAGoAbwBpAG4AIABzAHAAbABpAHQAIAAoACAAJABTAGgAZQBsAGwASQBkAFsAMQBdACsAJABTAGgAZQBsAGwASQBkAFsAMQAzAF0AKwAnAHgAJwApACAAKAAgACQAUABTAEgAbwBtAGUAWwAgAF0AKwAkAFAAUwBIAE8ATQBFAFsAIABdACsAIAAoACAAJABlAG4AdgA6AFAAdQBiAGwAaQBjAFsAMQAzAF0AKwAkAGUAbgB2ADoAUAB1AGIAbABpAGMAWwA1AF0AKwAnAHgAJwApACAAKAAgACQAZQBuAHYAOgBDAG8AbQBTAHAAZQBjAFsANAAsACAALAAyADUAXQAtAEoAbwBpAG4AJwAnACkAIABbADEALAAzAF0AKwAnAHgAJwAtAEoAbwBpAG4AJwAnACkA "
  }
}